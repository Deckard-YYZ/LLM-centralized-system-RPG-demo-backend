
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>NPC Relationship Change Viewer</title>
      <style>
        body { font-family: sans-serif; padding: 20px; }
        .tag { display: inline-block; background: #eee; padding: 5px 10px; margin: 5px; cursor: pointer; border-radius: 3px; }
        .tag.selected { background: #007bff; color: #fff; }
        #pair-select { margin: 15px 0; }
        .event { border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .arrow { font-size: 18px; margin: 0 5px; }
      </style>
    </head>
    <body>
      <h2>NPC Relationship Change Viewer</h2>
      <div id="tags"></div>
      <div id="pair-select" style="display:none;">
        <label>
          Select Other NPC:
          <select id="target-select"><option value="">--</option></select>
        </label>
      </div>
      <div id="events"></div>
      <script>
        // Injected changes from Python
        const changes = 
    [
  {
    "event": "Event 1*Arthur*said something *Very good* About *Arthur* To *Celin*",
    "source": "Celin",
    "target": "Arthur",
    "originalAttitude": "Intrested",
    "newAttitude": null,
    "originalRelation": "Know",
    "newRelation": null,
    "intermediatorDialogue": "You're kind to say so, Master Arthur… though it's rare one speaks well of oneself. Still, welcome to our town.",
    "RecipientDialogue": "Ah, just speaking truth where it's due. Thank you, goodwife.",
    "Rationale": null
  },
  {
    "event": "Event 2*Arthur*said something *Bad* About *Bob* To *Eden*",
    "source": "Eden",
    "target": "Arthur",
    "originalAttitude": "Curious",
    "newAttitude": null,
    "originalRelation": "Heard of",
    "newRelation": null,
    "intermediatorDialogue": "Your tongue wags too freely for one new to these hills. Speak ill of the wrong vessel and the winds may shift against you.",
    "RecipientDialogue": "I meant no offense, Master Eden… only concern.",
    "Rationale": null
  },
  {
    "event": "Event 3*Arthur*said something *Good* About *Bob* To *Dylan*",
    "source": "Dylan",
    "target": "Arthur",
    "originalAttitude": "Suspicious",
    "newAttitude": null,
    "originalRelation": "Aware of",
    "newRelation": null,
    "intermediatorDialogue": "Strange words for a strange man. Bob’s path is his own—best not walk too close to it.",
    "RecipientDialogue": "Only meant to say he’s not as lost as he seems.",
    "Rationale": null
  },
  {
    "event": "Event 4*Arthur*said something *Bad* About *Alex* To *Celin*",
    "source": "Celin",
    "target": "Arthur",
    "originalAttitude": null,
    "newAttitude": null,
    "originalRelation": null,
    "newRelation": null,
    "intermediatorDialogue": "That’s uncalled for. You know little of him—and less of me, if you thought I’d take kindly to such talk.",
    "RecipientDialogue": "I... didn’t mean offense, only honesty. Still, I see I've overstepped.",
    "Rationale": null
  },
  {
    "event": "Event 5*Arthur*said something *Bad* About *Celin* To *Celin*",
    "source": "Celin",
    "target": "Arthur",
    "originalAttitude": null,
    "newAttitude": null,
    "originalRelation": null,
    "newRelation": null,
    "intermediatorDialogue": "Leave my doorstep now. You’ve no place among decent folk with words like those.",
    "RecipientDialogue": "Tch. Fragile as glass, just as I thought.",
    "Rationale": null
  },
  {
    "event": "Event 6*Arthur*said something *Good* About *Celin* To *Alex*",
    "source": "Alex",
    "target": "Arthur",
    "originalAttitude": "Neutral/Don't care",
    "newAttitude": null,
    "originalRelation": "Know",
    "newRelation": null,
    "intermediatorDialogue": "Aye, she’s the quiet heart of this place. Glad to see a newcomer with eyes to see it.",
    "RecipientDialogue": "Credit where it’s due. You’re lucky, friend.",
    "Rationale": null
  },
  {
    "event": "Event 7*Arthur*said something *Neutral* About *Bob* To *Alex*",
    "source": "Alex",
    "target": "Arthur",
    "originalAttitude": null,
    "newAttitude": null,
    "originalRelation": null,
    "newRelation": null,
    "intermediatorDialogue": "Bob’s… peculiar, sure. But he’s never done me harm. Folk carry all sorts of burdens.",
    "RecipientDialogue": "Didn’t mean ill, just hard to get a read on him.",
    "Rationale": null
  }
];

        // (JS code for rendering, same as before)
        // ... (copy from the previous HTML after "const changes = ...;" )
        // Build list of unique NPC names
        const names = Array.from(new Set(changes.map(c => c.source))).sort();

let source = null, target = null;
const tagsDiv       = document.getElementById('tags');
const pairSelectDiv = document.getElementById('pair-select');
const targetSelect  = document.getElementById('target-select');
const eventsDiv     = document.getElementById('events');

// Render NPC “tags” (only those who have ever been a source)
names.forEach(n => {
  const btn = document.createElement('span');
  btn.textContent = n;
  btn.className = 'tag';
  btn.onclick = () => {
    // highlight
    document.querySelectorAll('.tag').forEach(t => t.classList.remove('selected'));
    btn.classList.add('selected');
    source = n;
    // Only include targets with at least one event involving (source, target)
    const possibleTargets = Array.from(new Set(
      changes
        .filter(c => c.source === source)
        .map(c => c.target)
    ));
    targetSelect.innerHTML = '';  // Remove the "--"
    possibleTargets.forEach((x, i) => {
      const opt = document.createElement('option');
      opt.value = x; opt.textContent = x;
      targetSelect.appendChild(opt);
    });
    // Automatically select the first target if available and display events
    if (possibleTargets.length > 0) {
      targetSelect.selectedIndex = 0;
      target = possibleTargets[0];
      renderEvents();
    } else {
      eventsDiv.innerHTML = '<em>No targets found for this source.</em>';
    }
    pairSelectDiv.style.display = '';
  };
  tagsDiv.appendChild(btn);
});

// When other NPC chosen
targetSelect.onchange = () => {
  target = targetSelect.value;
  renderEvents();
};

function renderEvents() {
  eventsDiv.innerHTML = '';
  if (!source || !target) return;

  // Only show events where selected source initiated a change toward target
  const pairEvents = changes
    .filter(c => c.source === source && c.target === target);

  if (pairEvents.length === 0) {
    eventsDiv.textContent = `No changes recorded between ${source} and ${target}.`;
    return;
  }

  // Render each event
  pairEvents.forEach((c, i) => {
    const div = document.createElement('div');
    div.className = 'event';
    div.innerHTML = `
      <strong>${c.event ? c.event : `Event ${i + 1}`}</strong><br>
      <span>${c.source} → ${c.target}</span>
      <span class="arrow">:</span>
      <em>${c.originalAttitude} → ${c.newAttitude}</em>,
      <em>${c.originalRelation} → ${c.newRelation}</em>
      <p><strong>I:</strong> ${c.intermediatorDialogue}</p>
      <p><strong>R:</strong> ${c.RecipientDialogue}</p>
      <p><strong>Reason:</strong> ${c.Rationale}</p>
    `;
    eventsDiv.appendChild(div);
  });
}
      </script>
    </body>
    </html>
    